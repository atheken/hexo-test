<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Just Lazy Enough. · AndrewTheken.com</title><meta name="description" content="Just Lazy Enough. - Andrew Theken"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://andrewtheken.com/atom.xml" title="AndrewTheken.com"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Just Lazy Enough.</h1><div class="post-info">Dec 31, 2014</div><div class="post-content"><p>There’s cases where memoizing a bit of data in memory can make dramatic improvements in performance (like a lookup table that changes infrequently, but is accessed frequently.) We may even find that as long as it’s “eventually consistent”, that’s good enough.<br>The .net 4.0 framework introduced a brilliant little class called Lazy<t>. With this class, you could pass a function that would get called once when a value was requested, and then would be stored for future requests. This was helpful when you didn’t know exactly when an expensive resource would be needed, or it didn’t make sense to load it at the moment when they system was getting initialized, for example.<br>One drawback of the Lazy<t> is that it will resolve the value one time, and then keep it for the lifetime of the Lazy instance. That’s where “LazyEnough<t>“ might come in handy. The idea of this class is similar, you initialize it in the same way you initialize Lazy<t>, but with one extra (optional) parameter, TimeSpan.<br>Once initialized, LazyEnough<t> will work almost identically to Lazy<t>, except that each time the TimeSpan elapses, the next call to Value will invalidate the currently memoized value, call the loader Func<t> again, and return the updated value (memoizing it in the process).</t></t></t></t></t></t></t></p>
<p><script src="https://gist.github.com/atheken/4014001.js"></script><br>You should note that this class intentionally doesn’t try to minimize the number of calls to the loader, the idea is that you’re getting a huge gain from just reducing the number of calls to the expensive resource, adding locking code for the rare case where multiple threads will contend to load the same resource is overkill.<br>Anyway, just thought I’d share, hope you enjoy!</p>
</div></article></div></section><footer><div class="paginator"><a href="/2014/12/31/2010-02-26-no-sql-no-problems-or-mo-sql-mo-problems/" class="prev">PREV</a><a href="/2014/12/31/2013-09-01-Essential-Tools-for-node.js/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2016 <a href="http://andrewtheken.com">Andrew Theken</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>